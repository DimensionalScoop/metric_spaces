(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     77966,       2082]
NotebookOptionsPosition[     74040,       2006]
NotebookOutlinePosition[     74447,       2022]
CellTagsIndexPosition[     74404,       2019]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"$Assumptions", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"p", " ", ">=", " ", "0"}], ",", " ", 
    RowBox[{"q0", ">=", "0"}], ",", " ", 
    RowBox[{"q1", " ", ">=", " ", "0"}], ",", " ", 
    RowBox[{"o0", ">=", "0"}], ",", 
    RowBox[{"o1", ">=", " ", "0"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.929084342164909*^9, 3.9290843515579853`*^9}, {
  3.929084696001156*^9, 3.92908471153253*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"99c276f4-e9ac-49d4-b3d6-f443da10833b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"p", "\[GreaterEqual]", "0"}], ",", 
   RowBox[{"q0", "\[GreaterEqual]", "0"}], ",", 
   RowBox[{"q1", "\[GreaterEqual]", "0"}], ",", 
   RowBox[{"o0", "\[GreaterEqual]", "0"}], ",", 
   RowBox[{"o1", "\[GreaterEqual]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.929084347762369*^9, 3.929084353617732*^9}, 
   3.929084712804722*^9, 3.929151619085857*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"2ad4a9f7-573e-4357-a450-4ca52fd00891"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hq", " ", "=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "/", "2"}], ")"}], "*", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"p", "-", "q0", "-", "q1"}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"p", "+", "q0", "-", "q1"}], ")"}]}], ")"}], "^", 
    RowBox[{"(", 
     RowBox[{"1", "/", "2"}], ")"}]}], "*", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p", "+", "q0", "+", "q1"}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}], "/", "p"}]}]}]], "Input",
 CellChangeTimes->{{3.9290601642160892`*^9, 3.929060180537672*^9}, {
  3.929060320463436*^9, 3.9290603270434237`*^9}, {3.929060659263307*^9, 
  3.929060671635701*^9}, {3.929084339232285*^9, 3.929084341325255*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"0be379ca-21e2-4f81-9588-6fa9b49421da"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SqrtBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}]}]], " ", 
   SqrtBox[
    RowBox[{"p", "+", "q0", "+", "q1"}]]}], 
  RowBox[{"2", " ", "p"}]]], "Output",
 CellChangeTimes->{{3.929060320828442*^9, 3.929060327450741*^9}, 
   3.929060672441107*^9, 3.9290842569296*^9, 3.929084355404505*^9, 
   3.929084716345986*^9, 3.9291516216490192`*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"1989d668-5251-438f-9450-b5a02eb21d1f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ho", " ", "=", " ", 
  RowBox[{
   RowBox[{"hq", " ", "/.", " ", 
    RowBox[{"q0", " ", "->", " ", "o0"}]}], " ", "/.", " ", 
   RowBox[{"q1", " ", "->", " ", "o1"}]}]}]], "Input",
 CellChangeTimes->{{3.9290606836029797`*^9, 3.929060698006557*^9}, {
  3.929151623144783*^9, 3.92915162418685*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"cdede2bf-2cfc-4128-bc9d-7bea4eb249d6"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SqrtBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}]}]], " ", 
   SqrtBox[
    RowBox[{"o0", "+", "o1", "+", "p"}]]}], 
  RowBox[{"2", " ", "p"}]]], "Output",
 CellChangeTimes->{3.929060698869389*^9, 3.929084269098507*^9, 
  3.929084356607875*^9, 3.9290847176880617`*^9, 3.929151624801408*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"25df73dd-ec22-4c39-b591-93c6070c1749"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mo", " ", "=", " ", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q0", "^", "2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "4"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"p", "-", "q0", "-", "q1"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], "*", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "+", "q0", "+", "q1"}], ")"}], "/", 
             RowBox[{"p", "^", "2"}]}]}]}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"q1", "^", "2"}], ">", 
        RowBox[{
         RowBox[{"p", "^", "2"}], "+", 
         RowBox[{"q0", "^", "2"}]}]}]}], "}"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q0", "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "4"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"p", "-", "q0", "-", "q1"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "+", "q0", "+", "q1"}], ")"}], "/", 
         RowBox[{"p", "^", "2"}]}]}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.929060175080639*^9, 3.9290601762248774`*^9}, 
   3.929060329644446*^9, {3.929060374925239*^9, 3.929060521235424*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"969b3a8e-e1f1-4541-b116-38f1fe9833c1"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"-", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["q0", "2"], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "q0", "-", "q1"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"p", "+", "q0", "+", "q1"}], ")"}]}], 
            RowBox[{"4", " ", 
             SuperscriptBox["p", "2"]}]]}]]}], 
        RowBox[{
         SuperscriptBox["q1", "2"], ">", 
         RowBox[{
          SuperscriptBox["p", "2"], "+", 
          SuperscriptBox["q0", "2"]}]}]},
       {
        SqrtBox[
         RowBox[{
          SuperscriptBox["q0", "2"], "+", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p", "-", "q0", "-", "q1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"p", "+", "q0", "+", "q1"}], ")"}]}], 
           RowBox[{"4", " ", 
            SuperscriptBox["p", "2"]}]]}]], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.9290604954147253`*^9, 3.929060521571611*^9}, 
   3.929060861068864*^9, {3.9290842694274893`*^9, 3.929084283352025*^9}, 
   3.929084357864046*^9, 3.92908471874146*^9, 3.929151626042493*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"fde46f1b-8b3b-488e-8893-0c8f0c8f9cf9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mo", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", "mo", "]"}]}]], "Input",
 CellChangeTimes->{{3.9290608408311253`*^9, 3.929060859175915*^9}, {
  3.929084383030355*^9, 3.929084390313229*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"c3c3fb85-c1a1-44bf-8aa6-0298d4a814d2"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["p", "2"], "+", 
   SuperscriptBox["q0", "2"], "-", 
   SuperscriptBox["q1", "2"]}], 
  RowBox[{"2", " ", "p"}]]], "Output",
 CellChangeTimes->{{3.929060841246922*^9, 3.929060863311853*^9}, 
   3.9290842695443077`*^9, 3.929084390878615*^9, 3.929084719880066*^9, 
   3.929151627024518*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"9eabcd70-53c5-40aa-81e2-ded779e711a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mq", " ", "=", " ", 
  RowBox[{
   RowBox[{"mo", " ", "/.", " ", 
    RowBox[{"q0", " ", "->", " ", "o0"}]}], " ", "/.", " ", 
   RowBox[{"q1", " ", "->", " ", "o1"}]}]}]], "Input",
 CellChangeTimes->{{3.9290605235797462`*^9, 3.9290606293522577`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"0537c5bb-4b89-4678-bf4e-dd4870214aa5"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["o0", "2"], "-", 
   SuperscriptBox["o1", "2"], "+", 
   SuperscriptBox["p", "2"]}], 
  RowBox[{"2", " ", "p"}]]], "Output",
 CellChangeTimes->{{3.929060606465876*^9, 3.929060629862928*^9}, 
   3.9290608648966417`*^9, {3.929084269669118*^9, 3.9290842902980556`*^9}, 
   3.92908436314085*^9, 3.929084393445787*^9, 3.929084721160823*^9, 
   3.929151627750092*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"ac87206f-a42e-430a-8795-18551263aa61"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dist2", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"hq", " ", "-", " ", "ho"}], ")"}], "^", "2"}], " ", "+", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"mq", " ", "-", " ", "mo"}], ")"}], "^", "2"}]}]}]], "Input",
 CellChangeTimes->{{3.929060620147553*^9, 3.929060623018086*^9}, {
  3.929060706226503*^9, 3.929060741421369*^9}, {3.9290608935160303`*^9, 
  3.929060901202196*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"3431187d-2633-488f-908b-63f9d0d35e4b"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SqrtBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}]}]], " ", 
        SqrtBox[
         RowBox[{"o0", "+", "o1", "+", "p"}]]}], 
       RowBox[{"2", " ", "p"}]]}], "+", 
     FractionBox[
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}]}]], " ", 
       SqrtBox[
        RowBox[{"p", "+", "q0", "+", "q1"}]]}], 
      RowBox[{"2", " ", "p"}]]}], ")"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["o0", "2"], "-", 
       SuperscriptBox["o1", "2"], "+", 
       SuperscriptBox["p", "2"]}], 
      RowBox[{"2", " ", "p"}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["p", "2"], "+", 
       SuperscriptBox["q0", "2"], "-", 
       SuperscriptBox["q1", "2"]}], 
      RowBox[{"2", " ", "p"}]]}], ")"}], "2"]}]], "Output",
 CellChangeTimes->{
  3.929060624671144*^9, 3.9290607418718157`*^9, 3.92906086869473*^9, 
   3.929060901779831*^9, {3.929084269734336*^9, 3.9290842920787153`*^9}, 
   3.9290843645270023`*^9, 3.929084394722432*^9, 3.929084722209149*^9, 
   3.929151628445862*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"a5a1c1e1-5eff-486d-8323-8b5a5842e006"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dist2", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", "dist2", "]"}]}]], "Input",
 CellChangeTimes->{{3.929084304527673*^9, 3.929084306319887*^9}, {
  3.929084417543263*^9, 3.929084418659026*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"69ef04e8-67ba-4d0d-a78b-9620ad97400b"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    SuperscriptBox["p", "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["o0", "2"], "-", 
       SuperscriptBox["o1", "2"], "-", 
       SuperscriptBox["q0", "2"], "+", 
       SuperscriptBox["q1", "2"]}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SqrtBox[
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"o0", "-", "o1", "-", "p"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"o0", "+", "o1", "+", "p"}], ")"}]}], ")"}]}]], "-", 
       SqrtBox[
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "-", "q0", "-", "q1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"p", "+", "q0", "+", "q1"}], ")"}]}], ")"}]}]]}], ")"}], 
     "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.9290607504267473`*^9, 3.929060774640828*^9}, {
   3.9290608725488586`*^9, 3.929060907841323*^9}, {3.929061030476891*^9, 
   3.9290610418169737`*^9}, {3.9290841950593157`*^9, 3.929084213741309*^9}, {
   3.929084279668804*^9, 3.929084300463214*^9}, 3.929084332601057*^9, 
   3.929084369137393*^9, {3.9290844042453012`*^9, 3.929084418954123*^9}, 
   3.929084763519682*^9, 3.92915163098626*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"bbc8f36f-bbe8-442c-acad-08b06dbb73a3"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.929084763768879*^9, 
  3.9290847654349546`*^9}},ExpressionUUID->"19111ef2-3266-44e7-b297-\
d3f596a31fb0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "copied", " ", "directly", " ", "from", " ", "the", " ", "sympy", " ", 
    "notebook"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"lb2", " ", "=", " ", 
    RowBox[{"Piecewise", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}], "*", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}]}], ")"}], "^", 
                   
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}]}], "*", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "+", "p"}], ")"}], "^", 
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}]}]}], "-", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}]}], ")"}], "^", 
                   
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}]}], "*", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "+", "q1"}], ")"}], "^", 
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}]}]}]}], ")"}], "^", "2"}], 
              "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"4", "*", 
                    RowBox[{"o0", "^", "2"}], "*", 
                    RowBox[{"p", "^", "2"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "+", "p"}], ")"}]}]}], ")"}], 
                  "^", 
                  RowBox[{"(", 
                   RowBox[{"1", "/", "2"}], ")"}]}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"4", "*", 
                    RowBox[{"p", "^", "2"}], "*", 
                    RowBox[{"q0", "^", "2"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "+", "q1"}], ")"}]}]}], ")"}], 
                  "^", 
                  RowBox[{"(", 
                   RowBox[{"1", "/", "2"}], ")"}]}]}], ")"}], "^", "2"}]}], 
             ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}]}], "/", "p"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"o1", "^", "2"}], ">", 
           RowBox[{
            RowBox[{"o0", "^", "2"}], "+", 
            RowBox[{"p", "^", "2"}]}]}], "&&", 
          RowBox[{
           RowBox[{"q1", "^", "2"}], ">", 
           RowBox[{
            RowBox[{"p", "^", "2"}], "+", 
            RowBox[{"q0", "^", "2"}]}]}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}], "*", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}]}], ")"}], "^", 
                   
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}]}], "*", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "+", "p"}], ")"}], "^", 
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}]}]}], "-", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}]}], ")"}], "^", 
                   
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}]}], "*", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "+", "q1"}], ")"}], "^", 
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}]}]}]}], ")"}], "^", "2"}], 
              "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"4", "*", 
                    RowBox[{"o0", "^", "2"}], "*", 
                    RowBox[{"p", "^", "2"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "+", "p"}], ")"}]}]}], ")"}], 
                  "^", 
                  RowBox[{"(", 
                   RowBox[{"1", "/", "2"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"4", "*", 
                    RowBox[{"p", "^", "2"}], "*", 
                    RowBox[{"q0", "^", "2"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "+", "q1"}], ")"}]}]}], ")"}], 
                  "^", 
                  RowBox[{"(", 
                   RowBox[{"1", "/", "2"}], ")"}]}]}], ")"}], "^", "2"}]}], 
             ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}]}], "/", "p"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"o1", "^", "2"}], ">", 
           RowBox[{
            RowBox[{"o0", "^", "2"}], "+", 
            RowBox[{"p", "^", "2"}]}]}], "||", 
          RowBox[{
           RowBox[{"q1", "^", "2"}], ">", 
           RowBox[{
            RowBox[{"p", "^", "2"}], "+", 
            RowBox[{"q0", "^", "2"}]}]}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}], "*", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}]}], ")"}], "^", 
                   
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}]}], "*", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "+", "p"}], ")"}], "^", 
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}]}]}], "-", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}]}], ")"}], "^", 
                   
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}]}], "*", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "+", "q1"}], ")"}], "^", 
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}]}]}]}], ")"}], "^", "2"}], 
              "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"4", "*", 
                    RowBox[{"o0", "^", "2"}], "*", 
                    RowBox[{"p", "^", "2"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "+", "p"}], ")"}]}]}], ")"}], 
                  "^", 
                  RowBox[{"(", 
                   RowBox[{"1", "/", "2"}], ")"}]}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"4", "*", 
                    RowBox[{"p", "^", "2"}], "*", 
                    RowBox[{"q0", "^", "2"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "+", "q1"}], ")"}]}]}], ")"}], 
                  "^", 
                  RowBox[{"(", 
                   RowBox[{"1", "/", "2"}], ")"}]}]}], ")"}], "^", "2"}]}], 
             ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}]}], "/", "p"}]}], ",", "True"}], 
        "}"}]}], "}"}], "]"}]}], "\n", 
   RowBox[{"^", "2"}]}]}]], "Input",
 CellChangeTimes->{{3.9290833519741993`*^9, 3.9290833573990088`*^9}, 
   3.929084136908306*^9, {3.929084423906247*^9, 3.92908448218939*^9}, {
   3.9290845130978537`*^9, 3.929084527118826*^9}, {3.929086067688089*^9, 
   3.92908606968692*^9}, 3.929086124553288*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"bdfe85c9-782a-412e-9f27-a1b49af5a5ff"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{
         FractionBox["1", 
          RowBox[{"2", " ", "p"}]], 
         RowBox[{"(", 
          RowBox[{"\[Sqrt]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SqrtBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}]}]], " ", 
                 SqrtBox[
                  RowBox[{"o0", "+", "o1", "+", "p"}]]}], "-", 
                RowBox[{
                 SqrtBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}]}]], " ", 
                 SqrtBox[
                  RowBox[{"p", "+", "q0", "+", "q1"}]]}]}], ")"}], "2"], "+", 
             
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Sqrt]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", 
                    SuperscriptBox["o0", "2"], " ", 
                    SuperscriptBox["p", "2"]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "+", "p"}], ")"}]}]}], ")"}]}], 
                "-", 
                RowBox[{"\[Sqrt]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", 
                    SuperscriptBox["p", "2"], " ", 
                    SuperscriptBox["q0", "2"]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "+", "q1"}], ")"}]}]}], ")"}]}]}],
                ")"}], "2"]}], ")"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["o1", "2"], ">", 
          RowBox[{
           SuperscriptBox["o0", "2"], "+", 
           SuperscriptBox["p", "2"]}]}], "&&", 
         RowBox[{
          SuperscriptBox["q1", "2"], ">", 
          RowBox[{
           SuperscriptBox["p", "2"], "+", 
           SuperscriptBox["q0", "2"]}]}]}]},
       {
        RowBox[{
         FractionBox["1", 
          RowBox[{"2", " ", "p"}]], 
         RowBox[{"(", 
          RowBox[{"\[Sqrt]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SqrtBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}]}]], " ", 
                 SqrtBox[
                  RowBox[{"o0", "+", "o1", "+", "p"}]]}], "-", 
                RowBox[{
                 SqrtBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}]}]], " ", 
                 SqrtBox[
                  RowBox[{"p", "+", "q0", "+", "q1"}]]}]}], ")"}], "2"], "+", 
             
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Sqrt]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", 
                    SuperscriptBox["o0", "2"], " ", 
                    SuperscriptBox["p", "2"]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "+", "p"}], ")"}]}]}], ")"}]}], 
                "+", 
                RowBox[{"\[Sqrt]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", 
                    SuperscriptBox["p", "2"], " ", 
                    SuperscriptBox["q0", "2"]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "+", "q1"}], ")"}]}]}], ")"}]}]}],
                ")"}], "2"]}], ")"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["o1", "2"], ">", 
          RowBox[{
           SuperscriptBox["o0", "2"], "+", 
           SuperscriptBox["p", "2"]}]}], "||", 
         RowBox[{
          SuperscriptBox["q1", "2"], ">", 
          RowBox[{
           SuperscriptBox["p", "2"], "+", 
           SuperscriptBox["q0", "2"]}]}]}]},
       {
        RowBox[{
         FractionBox["1", 
          RowBox[{"2", " ", "p"}]], 
         RowBox[{"(", 
          RowBox[{"\[Sqrt]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SqrtBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}]}]], " ", 
                 SqrtBox[
                  RowBox[{"o0", "+", "o1", "+", "p"}]]}], "-", 
                RowBox[{
                 SqrtBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}]}]], " ", 
                 SqrtBox[
                  RowBox[{"p", "+", "q0", "+", "q1"}]]}]}], ")"}], "2"], "+", 
             
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Sqrt]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", 
                    SuperscriptBox["o0", "2"], " ", 
                    SuperscriptBox["p", "2"]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "+", "p"}], ")"}]}]}], ")"}]}], 
                "-", 
                RowBox[{"\[Sqrt]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", 
                    SuperscriptBox["p", "2"], " ", 
                    SuperscriptBox["q0", "2"]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "+", "q1"}], ")"}]}]}], ")"}]}]}],
                ")"}], "2"]}], ")"}]}], ")"}]}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.92908413769*^9, 3.929084420893551*^9, 3.9290844831395693`*^9, {
   3.9290845137046747`*^9, 3.929084527704245*^9}, 3.92908612701315*^9, 
   3.929151632751659*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"95c547cc-0f87-4ee9-be59-586f4b4c08e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "lb2", "]"}]], "Input",
 CellChangeTimes->{{3.929084145129798*^9, 3.929084164324951*^9}, {
   3.929084489045651*^9, 3.9290844899449577`*^9}, 3.929084522478598*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"846f4105-516d-46b5-87d6-2de76143baf0"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "p"], 
  RowBox[{"(", 
   RowBox[{"\[Sqrt]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["o0", "2"], " ", 
       SuperscriptBox["p", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["p", "2"], " ", 
       SuperscriptBox["q0", "2"]}], "-", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"o0", "+", "o1", "+", "p"}], ")"}]}]], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"p", "+", "q0", "+", "q1"}], ")"}]}]]}], "-", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["o0", "2"], "-", 
         SuperscriptBox["o1", "2"], "+", 
         SuperscriptBox["p", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["p", "2"], "+", 
         SuperscriptBox["q0", "2"], "-", 
         SuperscriptBox["q1", "2"]}], ")"}]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.929084148595942*^9, 3.929084180835299*^9, 3.929084490490197*^9, {
   3.92908452358786*^9, 3.929084531187996*^9}, 3.929086129854052*^9, 
   3.929151635037745*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"a741781e-27f5-4bef-8f8b-616881037c02"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ub2", " ", "=", " ", 
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], "*", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}]}], ")"}], "^", 
                  
                  RowBox[{"(", 
                   RowBox[{"1", "/", "2"}], ")"}]}], "*", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"o0", "+", "o1", "+", "p"}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"1", "/", "2"}], ")"}]}]}], "+", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}]}], ")"}], "^", 
                  
                  RowBox[{"(", 
                   RowBox[{"1", "/", "2"}], ")"}]}], "*", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"p", "+", "q0", "+", "q1"}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"1", "/", "2"}], ")"}]}]}]}], ")"}], "^", "2"}], 
             "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", "*", 
                    RowBox[{"o0", "^", "2"}], "*", 
                    RowBox[{"p", "^", "2"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "+", "p"}], ")"}]}]}], ")"}], 
                 "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", "2"}], ")"}]}], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", "*", 
                    RowBox[{"p", "^", "2"}], "*", 
                    RowBox[{"q0", "^", "2"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "+", "q1"}], ")"}]}]}], ")"}], 
                 "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", "2"}], ")"}]}]}], ")"}], "^", "2"}]}], 
            ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}]}], "/", "p"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"o1", "^", "2"}], ">", 
          RowBox[{
           RowBox[{"o0", "^", "2"}], "+", 
           RowBox[{"p", "^", "2"}]}]}], "&&", 
         RowBox[{
          RowBox[{"q1", "^", "2"}], ">", 
          RowBox[{
           RowBox[{"p", "^", "2"}], "+", 
           RowBox[{"q0", "^", "2"}]}]}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], "*", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}]}], ")"}], "^", 
                  
                  RowBox[{"(", 
                   RowBox[{"1", "/", "2"}], ")"}]}], "*", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"o0", "+", "o1", "+", "p"}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"1", "/", "2"}], ")"}]}]}], "+", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}]}], ")"}], "^", 
                  
                  RowBox[{"(", 
                   RowBox[{"1", "/", "2"}], ")"}]}], "*", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"p", "+", "q0", "+", "q1"}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"1", "/", "2"}], ")"}]}]}]}], ")"}], "^", "2"}], 
             "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", "*", 
                    RowBox[{"o0", "^", "2"}], "*", 
                    RowBox[{"p", "^", "2"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "+", "p"}], ")"}]}]}], ")"}], 
                 "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", "2"}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", "*", 
                    RowBox[{"p", "^", "2"}], "*", 
                    RowBox[{"q0", "^", "2"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "+", "q1"}], ")"}]}]}], ")"}], 
                 "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", "2"}], ")"}]}]}], ")"}], "^", "2"}]}], 
            ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}]}], "/", "p"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"o1", "^", "2"}], ">", 
          RowBox[{
           RowBox[{"o0", "^", "2"}], "+", 
           RowBox[{"p", "^", "2"}]}]}], "||", 
         RowBox[{
          RowBox[{"q1", "^", "2"}], ">", 
          RowBox[{
           RowBox[{"p", "^", "2"}], "+", 
           RowBox[{"q0", "^", "2"}]}]}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], "*", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}]}], ")"}], "^", 
                  
                  RowBox[{"(", 
                   RowBox[{"1", "/", "2"}], ")"}]}], "*", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"o0", "+", "o1", "+", "p"}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"1", "/", "2"}], ")"}]}]}], "+", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}]}], ")"}], "^", 
                  
                  RowBox[{"(", 
                   RowBox[{"1", "/", "2"}], ")"}]}], "*", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"p", "+", "q0", "+", "q1"}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"1", "/", "2"}], ")"}]}]}]}], ")"}], "^", "2"}], 
             "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", "*", 
                    RowBox[{"o0", "^", "2"}], "*", 
                    RowBox[{"p", "^", "2"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "+", "p"}], ")"}]}]}], ")"}], 
                 "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", "2"}], ")"}]}], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", "*", 
                    RowBox[{"p", "^", "2"}], "*", 
                    RowBox[{"q0", "^", "2"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "+", "q1"}], ")"}]}]}], ")"}], 
                 "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", "2"}], ")"}]}]}], ")"}], "^", "2"}]}], 
            ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}]}], "/", "p"}]}], ",", "True"}], 
       "}"}]}], "}"}], "]"}]}], "\n"}], "\n", 
 RowBox[{"^", "2"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.929084610349553*^9, 3.929084628368531*^9}, 
   3.9290861055419903`*^9, {3.929086156024948*^9, 3.929086193309548*^9}},
 EmphasizeSyntaxErrors->True,
 CellLabel->"In[11]:=",ExpressionUUID->"7bbe5d14-c9cc-4926-a3ea-025a3805f62e"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{
         FractionBox["1", 
          RowBox[{"2", " ", "p"}]], 
         RowBox[{"(", 
          RowBox[{"\[Sqrt]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SqrtBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}]}]], " ", 
                 SqrtBox[
                  RowBox[{"o0", "+", "o1", "+", "p"}]]}], "+", 
                RowBox[{
                 SqrtBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}]}]], " ", 
                 SqrtBox[
                  RowBox[{"p", "+", "q0", "+", "q1"}]]}]}], ")"}], "2"], "+", 
             
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Sqrt]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", 
                    SuperscriptBox["o0", "2"], " ", 
                    SuperscriptBox["p", "2"]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "+", "p"}], ")"}]}]}], ")"}]}], 
                "-", 
                RowBox[{"\[Sqrt]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", 
                    SuperscriptBox["p", "2"], " ", 
                    SuperscriptBox["q0", "2"]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "+", "q1"}], ")"}]}]}], ")"}]}]}],
                ")"}], "2"]}], ")"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["o1", "2"], ">", 
          RowBox[{
           SuperscriptBox["o0", "2"], "+", 
           SuperscriptBox["p", "2"]}]}], "&&", 
         RowBox[{
          SuperscriptBox["q1", "2"], ">", 
          RowBox[{
           SuperscriptBox["p", "2"], "+", 
           SuperscriptBox["q0", "2"]}]}]}]},
       {
        RowBox[{
         FractionBox["1", 
          RowBox[{"2", " ", "p"}]], 
         RowBox[{"(", 
          RowBox[{"\[Sqrt]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SqrtBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}]}]], " ", 
                 SqrtBox[
                  RowBox[{"o0", "+", "o1", "+", "p"}]]}], "+", 
                RowBox[{
                 SqrtBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}]}]], " ", 
                 SqrtBox[
                  RowBox[{"p", "+", "q0", "+", "q1"}]]}]}], ")"}], "2"], "+", 
             
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Sqrt]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", 
                    SuperscriptBox["o0", "2"], " ", 
                    SuperscriptBox["p", "2"]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "+", "p"}], ")"}]}]}], ")"}]}], 
                "+", 
                RowBox[{"\[Sqrt]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", 
                    SuperscriptBox["p", "2"], " ", 
                    SuperscriptBox["q0", "2"]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "+", "q1"}], ")"}]}]}], ")"}]}]}],
                ")"}], "2"]}], ")"}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["o1", "2"], ">", 
          RowBox[{
           SuperscriptBox["o0", "2"], "+", 
           SuperscriptBox["p", "2"]}]}], "||", 
         RowBox[{
          SuperscriptBox["q1", "2"], ">", 
          RowBox[{
           SuperscriptBox["p", "2"], "+", 
           SuperscriptBox["q0", "2"]}]}]}]},
       {
        RowBox[{
         FractionBox["1", 
          RowBox[{"2", " ", "p"}]], 
         RowBox[{"(", 
          RowBox[{"\[Sqrt]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SqrtBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}]}]], " ", 
                 SqrtBox[
                  RowBox[{"o0", "+", "o1", "+", "p"}]]}], "+", 
                RowBox[{
                 SqrtBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}]}]], " ", 
                 SqrtBox[
                  RowBox[{"p", "+", "q0", "+", "q1"}]]}]}], ")"}], "2"], "+", 
             
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Sqrt]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", 
                    SuperscriptBox["o0", "2"], " ", 
                    SuperscriptBox["p", "2"]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"o0", "+", "o1", "+", "p"}], ")"}]}]}], ")"}]}], 
                "-", 
                RowBox[{"\[Sqrt]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", 
                    SuperscriptBox["p", "2"], " ", 
                    SuperscriptBox["q0", "2"]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"p", "+", "q0", "+", "q1"}], ")"}]}]}], ")"}]}]}],
                ")"}], "2"]}], ")"}]}], ")"}]}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.929084628748353*^9, {3.92908610711485*^9, 3.929086193986002*^9}, 
   3.929151637267228*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"6531459e-633e-4b37-8a87-78d724abfbd7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ub2", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", "ub2", "]"}]}]], "Input",
 CellChangeTimes->{{3.929086176319722*^9, 3.929086200922484*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"0392dca3-64be-4e28-b4e5-780627dae972"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "p"], 
  RowBox[{"(", 
   RowBox[{"\[Sqrt]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["o0", "2"], " ", 
       SuperscriptBox["p", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["p", "2"], " ", 
       SuperscriptBox["q0", "2"]}], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"o0", "+", "o1", "+", "p"}], ")"}]}]], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"p", "+", "q0", "+", "q1"}], ")"}]}]]}], "-", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["o0", "2"], "-", 
         SuperscriptBox["o1", "2"], "+", 
         SuperscriptBox["p", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["p", "2"], "+", 
         SuperscriptBox["q0", "2"], "-", 
         SuperscriptBox["q1", "2"]}], ")"}]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.929086180886498*^9, 3.9290862011135197`*^9}, 
   3.9291516405867567`*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"727c25e4-4830-479a-9c51-2844778c3a98"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.929086172153255*^9, 
  3.9290861738509502`*^9}},ExpressionUUID->"1f2bc9e9-585f-44cf-b29a-\
741c28190452"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"ub2", "==", "lb2"}], "]"}]], "Input",
 CellChangeTimes->{{3.9290846645094223`*^9, 3.929084674906247*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"5c3f71db-6130-4123-95b8-4875c539b3a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "p"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Sqrt]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["o0", "2"], " ", 
         SuperscriptBox["p", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["p", "2"], " ", 
         SuperscriptBox["q0", "2"]}], "-", 
        RowBox[{
         SqrtBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"o0", "+", "o1", "+", "p"}], ")"}]}]], " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"p", "+", "q0", "+", "q1"}], ")"}]}]]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["o0", "2"], "-", 
           SuperscriptBox["o1", "2"], "+", 
           SuperscriptBox["p", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["p", "2"], "+", 
           SuperscriptBox["q0", "2"], "-", 
           SuperscriptBox["q1", "2"]}], ")"}]}]}], ")"}]}], "-", 
     RowBox[{"\[Sqrt]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["o0", "2"], " ", 
         SuperscriptBox["p", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["p", "2"], " ", 
         SuperscriptBox["q0", "2"]}], "+", 
        RowBox[{
         SqrtBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"o0", "+", "o1", "+", "p"}], ")"}]}]], " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"p", "+", "q0", "+", "q1"}], ")"}]}]]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["o0", "2"], "-", 
           SuperscriptBox["o1", "2"], "+", 
           SuperscriptBox["p", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["p", "2"], "+", 
           SuperscriptBox["q0", "2"], "-", 
           SuperscriptBox["q1", "2"]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
  "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{{3.929084667536989*^9, 3.9290846752536383`*^9}, 
   3.9290861350781107`*^9, 3.929086207004808*^9, 3.9291516453383713`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"9b8f6e26-1a2b-486a-90e4-4e49c2b50320"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ptolb2", " ", "=", " ", 
  RowBox[{"Sqrt", "[", 
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{"q0", "*", "o1"}], " ", "-", " ", 
      RowBox[{"q1", "*", "o0"}]}], "]"}], "/", "p"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.929086832918947*^9, 3.929086916733679*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"c39644d1-3630-4397-b809-05dae187c7f4"],

Cell[BoxData[
 RowBox[{
  SqrtBox[
   FractionBox["1", "p"]], " ", 
  SqrtBox[
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"o1", " ", "q0"}], "-", 
     RowBox[{"o0", " ", "q1"}]}], "]"}]]}]], "Output",
 CellChangeTimes->{{3.9290868693441057`*^9, 3.929086886813662*^9}, 
   3.9290869173334007`*^9, 3.929151646698844*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"85ca70d3-8adf-418f-8b56-cdafe0859ffd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{"lb2", " ", "==", " ", "dist2"}], "]"}]], "Input",
 CellChangeTimes->{{3.929086887748639*^9, 3.929086951419956*^9}, {
  3.929151656169963*^9, 3.929151658286471*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"9a2bc1cd-5f5a-43a7-9b26-3f396c59726c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   SuperscriptBox["p", 
    RowBox[{"3", "/", "2"}]], " ", 
   SqrtBox[
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{"o1", " ", "q0"}], "-", 
      RowBox[{"o0", " ", "q1"}]}], "]"}]]}], ">", 
  RowBox[{"2", " ", "p", " ", 
   RowBox[{"\[Sqrt]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["o0", "2"], " ", 
       SuperscriptBox["p", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["p", "2"], " ", 
       SuperscriptBox["q0", "2"]}], "-", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"o0", "+", "o1", "-", "p"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"o0", "-", "o1", "+", "p"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "o0"}], "+", "o1", "+", "p"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"o0", "+", "o1", "+", "p"}], ")"}]}]], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "+", "q0", "-", "q1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"p", "-", "q0", "+", "q1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "p"}], "+", "q0", "+", "q1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"p", "+", "q0", "+", "q1"}], ")"}]}]]}], "-", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["o0", "2"], "-", 
         SuperscriptBox["o1", "2"], "+", 
         SuperscriptBox["p", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["p", "2"], "+", 
         SuperscriptBox["q0", "2"], "-", 
         SuperscriptBox["q1", "2"]}], ")"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.929086894085979*^9, 3.9290869255923967`*^9}},
 CellLabel->"Out[77]=",ExpressionUUID->"207614ca-d560-47ff-b3ba-9700fafaac59"]
}, Open  ]],

Cell[BoxData["lb2"], "Input",
 CellChangeTimes->{{3.929151589300788*^9, 
  3.9291515904938707`*^9}},ExpressionUUID->"006ec2ca-fb75-491c-af29-\
6b08b692fce3"]
},
WindowSize->{709.5, 889.5},
WindowMargins->{{Automatic, 725.25}, {-894.75, Automatic}},
FrontEndVersion->"14.0 for Linux x86 (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ebb88c65-c94c-422b-bae5-d9e8e47c2eb2"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 515, 11, 31, "Input",ExpressionUUID->"99c276f4-e9ac-49d4-b3d6-f443da10833b"],
Cell[1098, 35, 489, 10, 33, "Output",ExpressionUUID->"2ad4a9f7-573e-4357-a450-4ca52fd00891"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1624, 50, 962, 26, 50, "Input",ExpressionUUID->"0be379ca-21e2-4f81-9588-6fa9b49421da"],
Cell[2589, 78, 672, 18, 61, "Output",ExpressionUUID->"1989d668-5251-438f-9450-b5a02eb21d1f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3298, 101, 399, 8, 29, "Input",ExpressionUUID->"cdede2bf-2cfc-4128-bc9d-7bea4eb249d6"],
Cell[3700, 111, 623, 17, 61, "Output",ExpressionUUID->"25df73dd-ec22-4c39-b591-93c6070c1749"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4360, 133, 1958, 54, 90, "Input",ExpressionUUID->"969b3a8e-e1f1-4541-b116-38f1fe9833c1"],
Cell[6321, 189, 2736, 76, 84, "Output",ExpressionUUID->"fde46f1b-8b3b-488e-8893-0c8f0c8f9cf9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9094, 270, 295, 5, 29, "Input",ExpressionUUID->"c3c3fb85-c1a1-44bf-8aa6-0298d4a814d2"],
Cell[9392, 277, 423, 10, 56, "Output",ExpressionUUID->"9eabcd70-53c5-40aa-81e2-ded779e711a5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9852, 292, 353, 7, 29, "Input",ExpressionUUID->"0537c5bb-4b89-4678-bf4e-dd4870214aa5"],
Cell[10208, 301, 496, 11, 56, "Output",ExpressionUUID->"ac87206f-a42e-430a-8795-18551263aa61"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10741, 317, 509, 12, 31, "Input",ExpressionUUID->"3431187d-2633-488f-908b-63f9d0d35e4b"],
Cell[11253, 331, 1801, 54, 167, "Output",ExpressionUUID->"a5a1c1e1-5eff-486d-8323-8b5a5842e006"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13091, 390, 299, 5, 29, "Input",ExpressionUUID->"69ef04e8-67ba-4d0d-a78b-9620ad97400b"],
Cell[13393, 397, 1818, 48, 83, "Output",ExpressionUUID->"bbc8f36f-bbe8-442c-acad-08b06dbb73a3"]
}, Open  ]],
Cell[15226, 448, 154, 3, 29, "Input",ExpressionUUID->"19111ef2-3266-44e7-b297-d3f596a31fb0"],
Cell[CellGroupData[{
Cell[15405, 455, 12964, 324, 551, "Input",ExpressionUUID->"bdfe85c9-782a-412e-9f27-a1b49af5a5ff"],
Cell[28372, 781, 10926, 280, 632, "Output",ExpressionUUID->"95c547cc-0f87-4ee9-be59-586f4b4c08e5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39335, 1066, 286, 4, 29, "Input",ExpressionUUID->"846f4105-516d-46b5-87d6-2de76143baf0"],
Cell[39624, 1072, 1842, 53, 110, "Output",ExpressionUUID->"a741781e-27f5-4bef-8f8b-616881037c02"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41503, 1130, 12514, 318, 571, "Input",ExpressionUUID->"7bbe5d14-c9cc-4926-a3ea-025a3805f62e"],
Cell[54020, 1450, 10857, 279, 632, "Output",ExpressionUUID->"6531459e-633e-4b37-8a87-78d724abfbd7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64914, 1734, 247, 4, 29, "Input",ExpressionUUID->"0392dca3-64be-4e28-b4e5-780627dae972"],
Cell[65164, 1740, 1752, 51, 110, "Output",ExpressionUUID->"727c25e4-4830-479a-9c51-2844778c3a98"]
}, Open  ]],
Cell[66931, 1794, 154, 3, 29, "Input",ExpressionUUID->"1f2bc9e9-585f-44cf-b29a-741c28190452"],
Cell[CellGroupData[{
Cell[67110, 1801, 240, 4, 29, "Input",ExpressionUUID->"5c3f71db-6130-4123-95b8-4875c539b3a2"],
Cell[67353, 1807, 3414, 95, 182, "Output",ExpressionUUID->"9b8f6e26-1a2b-486a-90e4-4e49c2b50320"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70804, 1907, 390, 9, 31, "Input",ExpressionUUID->"c39644d1-3630-4397-b809-05dae187c7f4"],
Cell[71197, 1918, 405, 11, 57, "Output",ExpressionUUID->"85ca70d3-8adf-418f-8b56-cdafe0859ffd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71639, 1934, 292, 5, 31, "Input",ExpressionUUID->"9a2bc1cd-5f5a-43a7-9b26-3f396c59726c"],
Cell[71934, 1941, 1930, 57, 134, "Output",ExpressionUUID->"207614ca-d560-47ff-b3ba-9700fafaac59"]
}, Open  ]],
Cell[73879, 2001, 157, 3, 29, "Input",ExpressionUUID->"006ec2ca-fb75-491c-af29-6b08b692fce3"]
}
]
*)

